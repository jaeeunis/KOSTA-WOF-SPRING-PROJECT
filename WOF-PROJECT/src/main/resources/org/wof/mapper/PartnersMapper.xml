<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.wof.mapper.PartnersMapper">

	<!-- 파트너스 찾기클릭시(파트너스 전체 리스트 불러오기) -->
	<select id="partnersList" resultType="org.wof.domain.PartnersVO">
		<![CDATA[
		select m.MEMBER_NO, m.REAL_NAME, p.BIRTHDAY, p.PREFERED_AREA, 
		p.CAREER, p.SKILL, p.HASHTAG, p.AVAILABLE_DATE, p.PROFILE, f.target_member
		from member m
        JOIN partners p
        on m.MEMBER_NO = p.MEMBER_NO
        left outer join followpartners f
        on p.member_no = f.target_member
		]]>
	</select>
	
	<!-- 관심 파트너스 체크 -->
	<select id="followCheck" parameterType="org.wof.domain.FollowPartnersVO" resultType="String">
		select count(*) from FOLLOWPARTNERS where SOURCE_MEMBER=#{source_member} and TARGET_MEMBER=#{target_member}
	</select>
	
	<!-- 관심 파트너스 입력 -->
	<insert id="followYes" parameterType="org.wof.domain.FollowPartnersVO">
		insert into FOLLOWPARTNERS (FOLLOWPARTNERS_NO, SOURCE_MEMBER, TARGET_MEMBER, FOLLOWING_DATE)
		values ('fpr'||follow_partner_seq.nextval, #{source_member}, #{target_member}, sysdate)
	</insert>
	
	<!-- 관심 파트너스 삭제 -->
	<delete id="followNo" parameterType="org.wof.domain.FollowPartnersVO">
		delete from FOLLOWPARTNERS where SOURCE_MEMBER=#{source_member} and TARGET_MEMBER=#{target_member}
	</delete>
	
	<!-- 관심파트너스 리스트 -->
	<select id="followList" parameterType="org.wof.domain.PartnersVO" resultType="org.wof.domain.PartnersVO">
		select p.MEMBER_NO, p.BIRTHDAY, p.PREFERED_AREA, p.CAREER, p.SKILL, p.HASHTAG
		from FOLLOWPARTNERS f, PARTNERS p
		where f.TARGET_MEMBER = p.MEMBER_NO
		and f.SOURCE_MEMBER = #{member_no}
	</select>
	
	
</mapper>