<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.wof.mapper.ProjectMapper2">


	<!-- 추천 프로젝트를 하기 위한 페이징과 검색 불러오기 -->
	<select id="ProjectList" resultType="org.wof.domain.ProjectVO">
	 <![CDATA[
		select *
		from 
		(
			select 
			rownum rn, proj_title, proj_work_place, proj_reqr_skill, proj_detail, proj_id
			from project
			where 
		]]>	
		<trim prefix="(" suffix=") AND " prefixOverrides="OR">
			<foreach item='type' collection="typeArr">
				<trim prefix="OR">
					<choose>
						<when test="type == 'T'.toString()">
							proj_title like '%'||#{keyword}||'%'
						</when>
						<when test="type == 'L'.toString()">
							proj_work_place like '%'||#{keyword}||'%'
						</when>
						<when test="type == 'S'.toString()">
							proj_reqr_skill like '%'||#{keyword}||'%'
						</when>
					</choose>
				</trim>
			</foreach>
		</trim>
		
		
		 <![CDATA[
			rownum <= #{pageNum} * #{amount}
		)
		where rn > (#{pageNum} -1 ) * #{amount}
	  ]]>
	</select>
	
	<select id="ProjectList2" resultType="org.wof.domain.ProjectVO">
			select * from project
		</select>
	
	<select id="totalProject" resultType="java.lang.Integer">
		select count(*) from project
	</select>
	
<!-- 	<select id="FollowProjectList" resultType="org.wof.domain.ProjectVO" >
    select p.*
	from follow_project fp, project p, mem_partner m 
	where p.proj_id = fp.related_proj and m.mem_id = fp.related_mem 
	and fp.related_mem = "member0009"
   </select> -->
   
   <!-- 관심 프로젝트 -->
   <insert id="addFollowProject" parameterType="org.wof.domain.FollowProjectVO">
   <![CDATA[
      INSERT INTO followproject VALUES (#{followproject_no}, #{related_project}, #{related_member}, sysdate)
    ]]>
   </insert>
   
   <delete id="deleteFollowProject" parameterType="java.lang.String">
   		delete from followproject where related_member = 'member28' and related_project = #{related_member}
   </delete> 
   
   <select id="followProjectList" resultType="org.wof.domain.FollowProjectVO">
   	select fp.* from followproject fp, project p where fp.related_project = p.proj_id
   </select>
   
   <update id="projectStatusUpdate">
    <![CDATA[
   update project set proj_status = 2 where proj_start_date <= sysdate
    ]]>
   </update>
   
   <select id="locationProject" resultType="org.wof.domain.ProjectVO">
   	select proj_work_place from project
   </select>

</mapper>